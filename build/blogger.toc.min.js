/** Copyright (c) 2013-2015 akinari tsugo */
(function(){function m(a){return function(){return a}}function n(a,c){function b(){}b.prototype=c.prototype;a.A=c.prototype;a.prototype=new b};function p(a,c){var b=String(a),d=c-b.length;if(0>=d)return b;for(;d--;)b="0"+b;return b};var q=/^(\d{4})-?(\d{2})?-?(\d{2})?T?(\d{2})?:?(\d{2})?:?(\d{2})?(\.\d+)?(\+|-|Z)?(\d{2})?:?(\d{2})?$/;
function r(a){var c,b,d,e,g,h,f,k;a=a.match(q);c=a[1];b=a[2]?parseInt(a[2],10)-1:0;d=a[3]?parseInt(a[3],10):1;e=a[4]?parseInt(a[4],10):0;g=a[5]?parseInt(a[5],10):0;h=a[6]?parseInt(a[6],10):0;f=a[7]?1E3*parseFloat(a[7]):0;c=new Date(c,b,d,e,g,h);c.setMilliseconds(f);f=c.getTimezoneOffset();if(a[8]){switch(a[8]){case "+":k=-(60*parseInt(a[9],10)+parseInt(a[10],10));break;case "-":k=60*parseInt(a[9],10)+parseInt(a[10],10);break;case "Z":k=0}c.setTime(c.getTime()-6E4*(f-k))}return c};function u(a,c){this.a=a;this.g=c;this.f=null;this.h()}u.prototype.getName=function(){return this.g.title.w};
u.prototype.h=function(){var a=this.a,c=this.g,b=document.createElement("span"),d=document.createElement("span"),e=document.createElement("span"),g=document.createElement("span"),h=document.createElement("a"),f;a.thumbnail.enabled&&(g.appendChild(v(this,c.media$thumbnail)),g.className="poststoc-thumbnail");a.published.enabled&&(f=r(c.published.$t),f=a.published.format.format(f),d.appendChild(document.createTextNode(f)),d.className="poststoc-published");a.updated.enabled&&(f=r(c.updated.$t),f=a.updated.format.format(f),
e.appendChild(document.createTextNode(f)),e.className="poststoc-updated");h.appendChild(document.createTextNode(c.title.$t));h.href=c.link[c.link.length-1].href;h.className="poststoc-title";a.thumbnail.enabled&&b.appendChild(g);a.published.enabled&&b.appendChild(d);a.updated.enabled&&b.appendChild(e);b.appendChild(h);b.className="poststoc-entry";this.f=b};
function v(a,c){var b=document.createElement("img");c?(b.src=c.url,b.className="poststoc-thumbnail-image"):(b.src=a.a.thumbnail.noImageURL,b.className="poststoc-thumbnail-noimage");return b};function w(a){this.a=a};function x(a){this.a=a}n(x,w);x.prototype.execute=function(a){a=a.entry||[];var c,b,d,e;c=document.createElement("ul");c.className="poststoc-list";d=0;for(e=a.length;d<e;d++)b=document.createElement("li"),b.appendChild(y(this,a[d])),b.className="poststoc-item",c.appendChild(b);return c};function y(a,c){c=new u(a.a,c);return c.f};function z(a,c){this.a=a;this.g=c;this.j=this.v=this.f=null;this.h()}z.prototype.getName=function(){return this.g.term};
z.prototype.h=function(){var a=this.a,c=this.g.term,b=document.createElement("div"),d=document.createElement("div"),e=document.createElement("a"),g=document.createElement("ul"),a="http://"+a.blogURL,a=a+"/search/label/",a=a+c;e.appendChild(document.createTextNode(c));e.href=a;e.className="poststoc-category-anchor";d.appendChild(e);d.className="poststoc-category-title";g.className="poststoc-list";b.appendChild(d);b.appendChild(g);b.className="poststoc-category";this.f=b;this.v=d;this.j=g};function A(a){this.a=a}n(A,w);A.prototype.execute=function(a){var c=this.a,b=a.entry||[];a=a.category||[];var d,e,g,h,f,k,s,F,l,t;h={};f=[];k=document.createDocumentFragment();d=0;for(g=b.length;d<g;d++)for(F=b[d],a=F.category||[],e=a.length;e--;)s=a[e],t=new u(c,F),l=h[s.term],l||(l=new z(c,s),h[s.term]=l,f[f.length]=l),s=t.f,l=l.j,t=document.createElement("li"),t.className="poststoc-item",t.appendChild(s),l.appendChild(t);f=this.sort(f);d=0;for(g=f.length;d<g;d++)k.appendChild(f[d].f);return k};
A.prototype.sort=function(a){return a};function B(a){this.a=a}n(B,A);B.prototype.sort=function(a){return a.sort(function(a,b){return a.j.childNodes.length<b.j.childNodes.length?1:-1})};function C(a){this.a=a}C.prototype.i=m("published");C.prototype.execute=function(){};function D(a){this.a=a}n(D,C);D.prototype.i=m("published");D.prototype.execute=function(a){switch((this.a.sort.order||"").toLocaleLowerCase()){case "asc":this.d(a);break;case "desc":this.c(a);break;default:this.c(a)}};D.prototype.d=function(a){(a.entry||[]).sort(function(a,b){return a.published.$t>b.published.$t?1:-1})};D.prototype.c=function(){};function E(a){this.a=a}n(E,A);E.prototype.sort=function(a){return a.sort(function(a,b){return a.getName()<b.getName()?-1:1})};function G(a){var c=null;switch(a){case "en-us":c=H;break;case "ja-jp":c=I;break;default:c=H}return c}
var H={n:["BC","AD"],p:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),o:"January February March April May June July August September October November December".split(" "),q:"Sun Mon Tue Wed Thu Fri Sat".split(" "),r:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),m:["AM","PM"],k:["EEEE dd MMMM y","dd MMMM y","dd MMM y","yyyy/MM/dd"],l:["h:mm:ss t zzzz","h:mm:ss t z","h:mm:ss t","h:mm t"]},I={n:["\u7d00\u5143\u524d","\u897f\u66a6"],p:"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),
o:"1\u6708 2\u6708 3\u6708 4\u6708 5\u6708 6\u6708 7\u6708 8\u6708 9\u6708 10\u6708 11\u6708 12\u6708".split(" "),q:"\u65e5\u66dc\u65e5 \u6708\u66dc\u65e5 \u706b\u66dc\u65e5 \u6c34\u66dc\u65e5 \u6728\u66dc\u65e5 \u91d1\u66dc\u65e5 \u571f\u66dc\u65e5".split(" "),r:"\u65e5\u6708\u706b\u6c34\u6728\u91d1\u571f".split(""),m:["\u5348\u524d","\u5348\u5f8c"],k:["y\u5e74M\u6708d\u65e5(EEEE)","y\u5e74M\u6708d\u65e5","yyyy/MM/dd","yy/MM/dd"],l:["H\u6642mm\u5206ss\u79d2 zzzz","H:mm:ss z","H:mm:ss","H:mm"]};function J(a,c){this.b=new G(c);if("number"===typeof a){var b="";4>a?b+=this.b.k[a]:8>a?b+=this.b.l[a-4]:(b+=this.b.k[a-8],b=b+" "+this.b.l[a-8]);a=b}this.pattern=a;this.t=[];this.locale=c;this.h()}J.prototype.format=function(a){var c=this.t,b,d,e,g=[];b=0;for(d=c.length;b<d;b++)e=c[b].text,1===c[b].type?g.push(K(this,e,a)):g.push(e);return g.join("")};
J.prototype.h=function(){for(var a=this.pattern,c=[/^[^\'GyMdHhtmsEz]+/,/^(?:G+|y+|M+|d+|H+|h+|t+|m+|s+|E+|z+)/],b=[],d,e;a;)for(e=c.length;e--;)if(d=a.match(c[e])){d=d[0];a=a.substring(d.length);b.push({text:d,type:e});break}this.t=b};
function K(a,c,b){var d=c.length;switch(c.charAt(0)){case "G":return a.b.n[0<b.getFullYear()?1:0];case "y":return a=b.getFullYear(),0>a&&(a=-a),2===d?p(a%100,2):String(a);case "M":a:switch(c=b.getMonth(),d){case 3:a=a.b.p[c];break a;case 4:a=a.b.o[c];break a;default:a=p(c+1,d)}return a;case "d":return p(b.getDate(),d);case "H":return p(b.getHours(),d);case "h":return p(b.getHours()%12,d);case "t":return d=b.getHours(),a.b.m[12<=d&&24>d?1:0];case "m":return p(b.getMinutes(),d);case "s":return p(b.getSeconds(),
d);case "E":return c=b.getDay(),4<=d?a.b.r[c]:a.b.q[c];case "z":return a=b.getTimezoneOffset()/60,0>a?a:"+"+a;default:return""}};function L(){M(this,this,POSTSTOC_SETTINGS,{blogURL:"garafu.blogspot.jp",maxResults:Infinity,sort:{key:"published",order:"default"},printby:"label",locale:"ja-jp",thumbnail:{enabled:!1,noImageURL:"http://garafu.github.io/blogger.toc/release/0.0.5/noimage.png"},published:{enabled:!1,format:"yyyy/MM/dd HH:mm:ss"},updated:{enabled:!1,format:"yyyy/MM/dd HH:mm:ss"}});this.sort.key=POSTSTOC_SETTINGS.orderby||this.sort.key;this.published.format=new J(this.published.format,this.locale);this.updated.format=
new J(this.updated.format,this.locale)}function M(a,c,b,d){var e;b=b||{};for(e in d)"object"===typeof d[e]?(c[e]=c[e]||{},M(a,c[e],b[e],d[e])):c[e]=void 0!==b[e]?b[e]:d[e]};function N(a,c,b){var d;N=d=window.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:window.attachEvent?function(a,b,c){a.attachEvent("on"+b,c)}:function(a,b,c){a["on"+b]=c};d(a,c,b)};function O(a){this.a=a}n(O,C);O.prototype.i=m("published");O.prototype.execute=function(a){switch((this.a.sort.order||"").toLocaleLowerCase()){case "asc":this.d(a);break;case "desc":this.c(a);break;default:this.d(a)}};O.prototype.d=function(a){(a.entry||[]).sort(function(a,b){return a.title.$t>b.title.$t?1:-1})};O.prototype.c=function(a){(a.entry||[]).sort(function(a,b){return a.title.$t<b.title.$t?1:-1})};function P(a){this.a=a}n(P,C);P.prototype.i=m("updated");P.prototype.execute=function(a){switch((this.a.sort.order||"").toLocaleLowerCase()){case "asc":this.d(a);break;case "desc":this.c(a);break;default:this.c(a)}};P.prototype.d=function(a){(a.entry||[]).sort(function(a,b){return a.updated.$t>b.updated.$t?1:-1})};P.prototype.c=function(){};function Q(){this.a=new L;this.s=R(this);this.u=aa(this);this.e=0;S(this)}var T="__garafu.blogger.toc__"+(new Date).getTime(),U=null,contract=contract||void 0,V=contract;function W(){var a=U;a||(U=a=new Q);return a}
function S(a){var c,b,d;c=a.e+1;d=a.e+500<a.a.maxResults?a.e+500:a.a.maxResults-a.e;var e=a.a;b=a.s;e="http://"+e.blogURL;e+="/feeds/posts/summary?";e+="redirect=false&";e+="start-index="+c+"&";e+="max-results="+d+"&";e+="orderby="+b.i()+"&";e+="alt=json-in-script&";e+="callback=";c=e+="garafu.blogger.toc.load";b=document.createElement("script");b.src=c;b.type="text/javascript";document.body.appendChild(b);a.e=d}Q.prototype.sort=function(a){this.s.execute(a.feed||{})};
Q.prototype.print=function(a){a=this.u.execute(a.feed||{});var c=document.createElement("div"),b=document.createElement("a");document.createElement("a");document.createElement("a");b.href="https://github.com/garafu/blogger.toc";b.appendChild(document.createTextNode('This page uses "blogger.toc" created by garafu.'));c.appendChild(b);c.style.display="block";c.style.fontSize="small";c.style.margin="20px 0";a.appendChild(c);document.getElementById(T).appendChild(a)};
function R(a){a=a.a;switch(a.sort.key.toLowerCase()){case "published":return new D(a);case "updated":return new P(a);case "title":return new O(a);default:return new D(a)}}function aa(a){a=a.a;switch(a.printby.toLowerCase()){case "title":return new x(a);case "label":return new A(a);case "label.nameorder":return new E(a);case "label.contentsorder":return new B(a);default:return new x(a)}}N(window,"load",function(){W()});document.write('<div id="'+T+'" class="poststoc">LOAD DATA ...</div>');
function X(a){var c,b,d;c=W();V?a.feed.entry&&0!=a.feed.entry.length&&(b=V.feed.entry,d=a.feed.entry,b=b.concat(d),V.feed.entry=b):V=a;if(c.a.maxResults<=c.e||!a.feed.entry||a.feed.entry&&0===a.feed.entry.length){for(a=document.getElementById(T);b=a.firstChild;)a.removeChild(b);c.sort(V);c.print(V)}else S(c)}var Y=["garafu","blogger","toc","load"],Z=this;Y[0]in Z||!Z.execScript||Z.execScript("var "+Y[0]);for(var $;Y.length&&($=Y.shift());)Y.length||void 0===X?Z=Z[$]?Z[$]:Z[$]={}:Z[$]=X;})();
