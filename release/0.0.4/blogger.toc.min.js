/** Copyright (c) 2013 akinari tsugo */
(function(){function h(a){return function(){return a}}function k(a,b){function c(){}c.prototype=b.prototype;a.r=b.prototype;a.prototype=new c};function l(a){this.a=a};function n(a){this.a=a}k(n,l);n.prototype.execute=function(a){a=a.entry||[];var b,c,e,d;b=document.createElement("ul");b.className="poststoc-list";e=0;for(d=a.length;e<d;e++)c=document.createElement("li"),c.appendChild(r(a[e])),c.className="poststoc-item",b.appendChild(c);return b};
function r(a){var b=document.createElement("span"),c=document.createElement("span"),e=document.createElement("span"),d=document.createElement("a");c.appendChild(document.createTextNode(a.published.$t));c.className="poststoc-published";e.appendChild(document.createTextNode(a.updated.$t));e.className="poststoc-updated";d.appendChild(document.createTextNode(a.title.$t));d.href=a.link[a.link.length-1].href;d.className="poststoc-title";b.appendChild(c);b.appendChild(e);b.appendChild(d);b.className="poststoc-entry";
return b};function s(a,b){this.a=a;this.c=b;this.d=null;this.g()}s.prototype.getName=function(){return this.c.title.o};
s.prototype.g=function(){var a=this.c,b=document.createElement("span"),c=document.createElement("span"),e=document.createElement("span"),d=document.createElement("a");c.appendChild(document.createTextNode(a.published.$t));c.className="poststoc-published";e.appendChild(document.createTextNode(a.updated.$t));e.className="poststoc-updated";d.appendChild(document.createTextNode(a.title.$t));d.href=a.link[a.link.length-1].href;d.className="poststoc-title";b.appendChild(c);b.appendChild(e);b.appendChild(d);
b.className="poststoc-entry";this.d=b};function t(a,b){this.a=a;this.c=b;this.f=this.n=this.d=null;this.g()}t.prototype.getName=function(){return this.c.term};
t.prototype.g=function(){var a=this.a,b=this.c.term,c=document.createElement("div"),e=document.createElement("div"),d=document.createElement("a"),f=document.createElement("ul"),a="http://"+a.j,a=a+"/search/label/",a=a+b;d.appendChild(document.createTextNode(b));d.href=a;d.className="poststoc-category-anchor";e.appendChild(d);e.className="poststoc-category-title";f.className="poststoc-list";c.appendChild(e);c.appendChild(f);c.className="poststoc-category";this.d=c;this.n=e;this.f=f};function u(a){this.a=a}k(u,l);u.prototype.execute=function(a){var b=this.a,c=a.entry||[];a=a.category||[];var e,d,f,C,m,D,p,E,g,q;C={};m=[];D=document.createDocumentFragment();e=0;for(f=c.length;e<f;e++)for(E=c[e],a=E.category||[],d=a.length;d--;)p=a[d],q=new s(b,E),g=C[p.term],g||(g=new t(b,p),C[p.term]=g,m[m.length]=g),p=q.d,g=g.f,q=document.createElement("li"),q.className="poststoc-item",q.appendChild(p),g.appendChild(q);m=this.sort(m);e=0;for(f=m.length;e<f;e++)D.appendChild(m[e].d);return D};
u.prototype.sort=function(a){return a};function v(a){this.a=a}k(v,u);v.prototype.sort=function(a){return a.sort(function(a,c){return a.f.childNodes.length<c.f.childNodes.length?1:-1})};function w(a){this.a=a}w.prototype.e=h("published");w.prototype.execute=function(){};function x(a){this.a=a}k(x,w);x.prototype.e=h("published");x.prototype.execute=function(){};function y(a){this.a=a}k(y,u);y.prototype.sort=function(a){return a.sort(function(a,c){return a.getName()<c.getName()?-1:1})};function z(){var a=window.POSTSTOC_SETTINGS||{};this.j=A(a.blogURL,"garafu.blogspot.jp");this.h=A(a.maxResults,Infinity);this.style=A(a.style,"");this.l=A(a.orderby,"published");this.m=A(a.printby,"label");this.p=A(a.labelListEnabled,!0);this.s=A(a.updatedDateEnabled,!1);this.q=A(a.publishedDateEnabled,!0)}function A(a,b){return void 0!==a?a:b};function B(a,b,c){var e;B=e=window.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:window.attachEvent?function(a,b,c){a.attachEvent("on"+b,c)}:function(a,b,c){a["on"+b]=c};e(a,b,c)};function F(a){this.a=a}k(F,w);F.prototype.e=h("published");F.prototype.execute=function(a){(a.entry||[]).sort(function(a,c){return a.title.$t>c.title.$t?1:-1})};function G(a){this.a=a}k(G,w);G.prototype.e=h("updated");G.prototype.execute=function(){};function H(){this.a=new z;this.i=I(this);this.k=J(this);this.b=0;K(this)}var L="__garafu.blogger.toc__"+(new Date).getTime(),M=null,contract=contract||void 0,N=contract;function O(){var a=M;a||(M=a=new H);return a}
function K(a){var b,c,e;b=a.b+1;e=a.b+500<a.a.h?a.b+500:a.a.h-a.b;var d=a.a;c=a.i;d="http://"+d.j;d+="/feeds/posts/summary?";d+="redirect=false&";d+="start-index="+b+"&";d+="max-results="+e+"&";d+="orderby="+c.e()+"&";d+="alt=json-in-script&";d+="callback=";b=d+="garafu.blogger.toc.load";c=document.createElement("script");c.src=b;c.type="text/javascript";document.body.appendChild(c);a.b=e}H.prototype.sort=function(a){this.i.execute(a.feed||{})};
H.prototype.print=function(a){a=this.k.execute(a.feed||{});var b=document.createElement("div"),c=document.createElement("a");document.createElement("a");document.createElement("a");c.href="https://github.com/garafu/blogger.toc";c.appendChild(document.createTextNode('This page uses "blogger.toc" created by garafu.'));b.appendChild(c);b.style.display="block";b.style.fontSize="small";b.style.margin="20px 0";a.appendChild(b);document.getElementById(L).appendChild(a)};
function I(a){a=a.a;switch(a.l.toLowerCase()){case "published":return new x(a);case "updated":return new G(a);case "title":return new F(a);default:return new x(a)}}function J(a){a=a.a;switch(a.m.toLowerCase()){case "title":return new n(a);case "label":return new u(a);case "label.nameorder":return new y(a);case "label.contentsorder":return new v(a);default:return new n(a)}}B(window,"load",function(){O()});document.write('<div id="'+L+'" class="poststoc">LOAD DATA ...</div>');
function P(a){var b,c,e;b=O();N?a.feed.entry&&0!=a.feed.entry.length&&(c=N.feed.entry,e=a.feed.entry,c=c.concat(e),N.feed.entry=c):N=a;if(b.a.h<=b.b||!a.feed.entry||a.feed.entry&&0===a.feed.entry.length){for(a=document.getElementById(L);c=a.firstChild;)a.removeChild(c);b.sort(N);b.print(N)}else K(b)}var Q=["garafu","blogger","toc","load"],R=this;Q[0]in R||!R.execScript||R.execScript("var "+Q[0]);for(var S;Q.length&&(S=Q.shift());)Q.length||void 0===P?R=R[S]?R[S]:R[S]={}:R[S]=P;})();
